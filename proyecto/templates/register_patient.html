<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro Paciente - YogaApp</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <style>
        .error-message {
            color: red;
            font-size: 0.8em;
            margin-top: 5px;
        }
        input:invalid {
            border-color: #ff9999;
        }
        input:valid {
            border-color: #99ff99;
        }
    </style>
</head>
<body>
    <h2>Registro de Paciente</h2>
    {% if error %}<div style="color:red">{{ error }}</div>{% endif %}
    <form method="POST" action="/register-patient" id="patientForm">
        <!-- Usuario -->
        <div>
            <label for="username">Usuario:</label>
            <input type="text" 
                   id="username" 
                   name="username" 
                   pattern="^[a-zA-Z0-9]{4,15}$"
                   title="4-15 caracteres (solo letras y números)"
                   required>
            <div class="error-message" id="usernameError">Mínimo 4 caracteres, solo letras y números</div>
        </div><br>

        <!-- Email -->
        <div>
            <label for="email">Email:</label>
            <input type="email" 
                   id="email" 
                   name="email" 
                   pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                   title="Ingrese un email válido"
                   required>
            <div class="error-message" id="emailError">Formato: usuario@dominio.com</div>
        </div><br>

        <!-- Nombre -->
        <div>
            <label for="firstName">Nombre:</label>
            <input type="text" 
                   id="firstName" 
                   name="firstName" 
                   pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑüÜ\s'-]+$"
                   title="Solo letras y espacios"
                   required>
            <div class="error-message" id="firstNameError">Solo letras, espacios, ' o -</div>
        </div><br>

        <!-- Apellido -->
        <div>
            <label for="lastName">Apellido:</label>
            <input type="text" 
                   id="lastName" 
                   name="lastName" 
                   pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑüÜ\s'-]+$"
                   title="Solo letras y espacios"
                   required>
            <div class="error-message" id="lastNameError">Solo letras, espacios, ' o -</div>
        </div><br>

        <!-- Contraseña -->
        <div>
            <label for="password">Contraseña:</label>
            <input type="password" 
                   id="password" 
                   name="password" 
                   pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[^a-zA-Z0-9])\S{8,}$"
                   title="Mínimo 8 caracteres con mayúscula, número y símbolo"
                   required>
            <div class="error-message" id="passwordError">8+ caracteres con mayúscula, número y símbolo</div>
        </div><br>

        <button type="submit">Registrar Paciente</button>
    </form>
    <p><a href="/">Volver al login</a></p>

    <script>
        // Validación en tiempo real
        document.getElementById('patientForm').addEventListener('input', function(e) {
            const input = e.target;
            const errorElement = document.getElementById(input.id + 'Error');
            
            if (input.validity.valid) {
                errorElement.style.display = 'none';
            } else {
                errorElement.style.display = 'block';
            }
        });
    </script>
</body>
</html>