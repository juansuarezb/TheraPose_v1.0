<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Instructor - TheraPose</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/static/css/instructor.css">
</head>
<body>
  <div class="dashboard-layout">
    <aside class="sidebar">
      <div class="logo"><i class="fas fa-spa"></i> TheraPose</div>
      <nav>
        <a href="#" id="nav-dashboard" class="active"><i class="fas fa-home"></i> Dashboard</a>
        <a href="#" id="nav-pacientes"><i class="fas fa-users"></i> Pacientes</a>
        <a href="#" id="nav-crear"><i class="fas fa-user-plus"></i> Registrar Paciente</a>
      </nav>
    </aside>
    
    <main class="main-content">
      <header class="header">
        <div style="font-weight:600; color:var(--color-primary-dark); font-size:1.1rem;">
          Bienvenido/a <span>{{ user.given_name }} {{ user.family_name }}</span>
        </div>  
        <button class="logout-btn" onclick="window.location.href='/logout'">
          <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
        </button>
      </header>
      
      <section id="dashboard-section" class="dashboard-cards">
        <div class="card">
          <div class="card-title"><i class="fas fa-user-circle"></i> Información del Instructor</div>
          <ul class="info-list">
            <li><strong>Nombre:</strong> {{ user.given_name }} {{ user.family_name }}</li>
            <li><strong>Email:</strong> {{ user.email }}</li>
          </ul>
        </div>
        <div class="card">
          <div class="card-title"><i class="fas fa-bolt"></i> Acciones Rápidas</div>
          <button class="btn-table" onclick="showSection('crear')">
            <i class="fas fa-user-plus"></i> Registrar Paciente
          </button>
          <button class="btn-table" style="margin-top: 10px;" onclick="window.location.href='/instructor/create-series'">
            <i class="fas fa-dumbbell"></i> Crear Serie Terapéutica
          </button>
        </div>
      </section>
      
      <section id="pacientes-section" class="dashboard-cards" style="display:none;">
        <div class="card" style="flex:1 1 100%; min-width:320px;">
          <div class="card-title"><i class="fas fa-users"></i> Mis Pacientes</div>
          {% if patients %}
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Nombre Completo</th>
                  <th>Email</th>
                  <th>Fecha de Nacimiento</th>
                  <th>Género</th>
                  <th>Celular</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                {% for patient in patients %}
                <tr>
                  <td>{{ patient.first_name }} {{ patient.last_name }}</td>
                  <td>{{ patient.email }}</td>
                  <td>{{ patient.fecha_nac }}</td>
                  <td>{{ patient.genero }}</td>
                  <td>{{ patient.celular }}</td>
                  <td><button class="btn-table">Ver Detalles</button></td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="alert-modern">No tienes pacientes registrados aún.</div>
          {% endif %}
        </div>
      </section>
      
      <section id="crear-section" class="dashboard-cards" style="display:none;">
        <form method="POST" action="/instructor/create-patient" class="form-modern" autocomplete="off">
          <div class="form-title"><i class="fas fa-user-plus"></i> Registrar Nuevo Paciente</div>
          {% if error %}
          <div class="alert-modern">{{ error }}</div>
          {% endif %}
          <div class="form-grid">
            <div class="form-group">
              <label for="username">Nombre de Usuario</label>
              <input type="text" id="username" name="username" required />
            </div>
            <div class="form-group">
              <label for="email">Correo Electrónico</label>
              <input type="email" id="email" name="email" required />
            </div>
            <div class="form-group">
              <label for="firstName">Nombre</label>
              <input type="text" id="firstName" name="firstName" required />
            </div>
            <div class="form-group">
              <label for="lastName">Apellido</label>
              <input type="text" id="lastName" name="lastName" required />
            </div>
            <div class="form-group">
              <label for="password">Contraseña</label>
              <input type="password" id="password" name="password" required />
            </div>
            <div class="form-group">
              <label for="fecha_nac">Fecha de nacimiento</label>
              <input type="date" id="fecha_nac" name="fecha_nac" required />
            </div>
            <div class="form-group">
              <label for="genero">Género</label>
              <select id="genero" name="genero" required>
                <option value="">Selecciona tu género</option>
                <option value="masculino">Masculino</option>
                <option value="femenino">Femenino</option>
                <option value="otro">Otro</option>
              </select>
            </div>
            <div class="form-group">
              <label for="celular">Celular (10 dígitos)</label>
              <input type="tel" id="celular" name="celular" pattern="^\d{10}$" maxlength="10" required />
            </div>
          </div>
          <button type="submit">Registrar Paciente</button>
        </form>
      </section>
    </main>
  </div>
  
  <script>
    function showSection(section) {
      // Ocultar todas las secciones
      document.getElementById('dashboard-section').style.display = section === 'dashboard' ? '' : 'none';
      document.getElementById('pacientes-section').style.display = section === 'pacientes' ? '' : 'none';
      document.getElementById('crear-section').style.display = section === 'crear' ? '' : 'none';
      
      // Actualizar navegación activa
      document.getElementById('nav-dashboard').classList.toggle('active', section === 'dashboard');
      document.getElementById('nav-pacientes').classList.toggle('active', section === 'pacientes');
      document.getElementById('nav-crear').classList.toggle('active', section === 'crear');
    }
    
    // Event listeners para navegación
    document.getElementById('nav-dashboard').onclick = function() { showSection('dashboard'); };
    document.getElementById('nav-pacientes').onclick = function() { showSection('pacientes'); };
    document.getElementById('nav-crear').onclick = function() { showSection('crear'); };
  </script>
</body>
</html>